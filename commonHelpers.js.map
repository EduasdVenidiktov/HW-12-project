{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["// ==========функція відправлення кур'єра на сервер===========\n\nimport axios from 'axios';\n\nexport async function fetchImages(query, currentPage) {\n  const BASE_URL = 'https://pixabay.com/';\n  const END_POINT = 'api/';\n  const url = `${BASE_URL}${END_POINT}`;\n\n  const params = {\n    key: '42263617-81d7156b9f7b88cd7b1016c2a',\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: 15,\n    page: currentPage,\n  };\n\n  const res = await axios.get(url, { params });\n  return res.data;\n}\n","export function templateImage(hit) {\n  const {\n    largeImageURL,\n    webformatURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n  } = hit;\n\n  return `<li class=\"gallery-item\" >\n    <a class=\"gallery-link\" href=\"${largeImageURL}\">\n      <img\n        class=\"gallery-image\"\n        src=\"${webformatURL}\"\n        alt=\"${tags}\"\n      />\n    </a>\n    <div class=\"item-text\">\n    <p><strong>Likes:</strong> ${likes}</p>\n    <p><strong>Views:</strong> ${views}</p>\n    <p><strong>Comments:</strong> ${comments}</p>\n    <p><strong>Downloads:</strong> ${downloads}</p>\n    </div>\n  </li>`;\n}\n\nexport function templateImages(hits) {\n  return hits.map(templateImage).join('');\n}\n","import { fetchImages } from './js/pixabay-api';\nimport { templateImages } from './js/render-functions';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n// ================ звернення до елементів =================\nconst refs = {\n  formEl: document.querySelector('.form'),\n  loadEl: document.querySelector('.loader'),\n  GalleryEl: document.querySelector('.gallery'),\n  loadMore: document.querySelector('.js-btn-load'), // знайшли кнопку loadMore\n};\n\n// ================= додаткові змінні ==============================\nlet query;\nlet page;\nlet maxPage;\n\n// =================  прослуховувачі подій  ================================\nrefs.formEl.addEventListener('submit', onFormSubmit);\nrefs.loadMore.addEventListener('click', onLoadMore);\n\n// ============= лоудер ====================\nconst showLoader = () => {\n  refs.loadEl.classList.remove('hidden'); // показує лоудер після Submit\n};\n\nconst hiddenLoader = () => {\n  refs.loadEl.classList.add('hidden'); //ховає лоудер після Submit\n};\n\n// =======================================================\nasync function onFormSubmit(ev) {\n  ev.preventDefault();\n  showLoader();\n  query = ev.target.elements.query.value.trim(); // отримання значення input без пробілів\n  // якщо нічого не введено в пошук\n  if (!query) {\n    showError();\n    hiddenLoader();\n    return;\n  }\n\n  page = 1;\n  try {\n    const data = await fetchImages(query, page); // відправлення кур'єра на пошук\n    maxPage = Math.ceil(data.totalHits / 15);\n    //================ якщо не знайдено нічого на сервері =================\n    if (data.hits.length === 0) {\n      ev.target.reset(); // очищення input\n\n      showErrorMessenge();\n      hiddenLoader();\n      return;\n    } else {\n      refs.GalleryEl.innerHTML = ''; // скидання розмітки після submit, але до рендеру\n      renderHits(data.hits);\n    }\n  } catch (error) {\n    showError(error);\n\n    maxPage = 0;\n\n    refs.GalleryEl.innerHTML = ''; // скидання розмітки після\n  }\n  hiddenLoader();\n  checkVisibleStatus();\n\n  ev.target.reset(); // очищення input\n}\n\n// =============== друга кнопка LoadMore =================\nasync function onLoadMore() {\n  page += 1;\n  showLoader();\n  const data = await fetchImages(query, page);\n  renderHits(data.hits);\n  hiddenLoader();\n\n  checkVisibleStatus(); // можна поставити перед page += 1;\n\n  const height =\n    refs.GalleryEl.firstElementChild.getBoundingClientRect().height;\n  scrollBy({\n    behavior: 'smooth',\n    top: height * 2,\n  });\n}\n\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionSelector: 'img',\n  captionType: 'attr',\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  animation: 250,\n  widthRatio: 0.8,\n  scaleImageToRatio: true,\n});\n\nfunction renderHits(hits) {\n  const markup = templateImages(hits);\n  refs.GalleryEl.insertAdjacentHTML('beforeend', markup); // додає нову розмітку\n  lightbox.refresh(); // Оновити модальне вікно зображення\n}\n\nfunction checkVisibleStatus() {\n  if (page >= maxPage) {\n    hiddenLoadBtn();\n    showErrorEnd();\n  } else {\n    showLoadBtn();\n  }\n}\n// ==================== errors ===================\nfunction showError() {\n  iziToast.error({\n    message: 'Please enter a search query.',\n    position: 'topRight',\n  });\n}\nfunction showErrorMessenge() {\n  iziToast.error({\n    backgroundColor: '#ff0000',\n    position: 'topRight',\n    maxWidth: 500,\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n  });\n}\nfunction showErrorEnd() {\n  iziToast.error({\n    backgroundColor: '#dc143c',\n    message: \"We're sorry, but you've reached the end of search results\",\n    position: 'bottomCenter',\n  });\n}\n\n// =============== кнопка loadMore ===================\nfunction showLoadBtn() {\n  refs.loadMore.classList.remove('hidden');\n} //показує кнопку loadMore\nfunction hiddenLoadBtn() {\n  refs.loadMore.classList.add('hidden');\n} //ховає кнопку loadMore\n"],"names":["fetchImages","query","currentPage","url","params","axios","templateImage","hit","largeImageURL","webformatURL","tags","likes","views","comments","downloads","templateImages","hits","refs","page","maxPage","onFormSubmit","onLoadMore","showLoader","hiddenLoader","ev","showError","data","showErrorMessenge","renderHits","checkVisibleStatus","height","lightbox","SimpleLightbox","markup","hiddenLoadBtn","showErrorEnd","showLoadBtn","iziToast"],"mappings":"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"}